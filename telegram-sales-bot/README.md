# üìä Telegram Sales Bot

Telegram-–±–æ—Ç –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø—Ä–æ–¥–∞–∂ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ –∫–æ—Å–º–µ—Ç–∏–∫–∏ —Å AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç—á—ë—Ç–æ–≤.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥–∞–∂
- üë§ **–õ–∏—Ü–æ** ‚Äî –∫—Ä–µ–º—ã, —Å—ã–≤–æ—Ä–æ—Ç–∫–∏, –º–∞—Å–∫–∏, —Ç–æ–Ω–∏–∫–∏
- üíá **–í–æ–ª–æ—Å—ã** ‚Äî —à–∞–º–ø—É–Ω–∏, –±–∞–ª—å–∑–∞–º—ã, —Å—Ç–∞–π–ª–∏–Ω–≥, —Å–ø–µ—Ü—É—Ö–æ–¥
- üß¥ **–¢–µ–ª–æ** ‚Äî –≥–µ–ª–∏ –¥–ª—è –¥—É—à–∞, –∫—Ä–µ–º—ã, —Å–∫—Ä–∞–±—ã, –∞–Ω—Ç–∏—Ü–µ–ª–ª—é–ª–∏—Ç
- üíÑ **–ú–∞–∫–∏—è–∂** ‚Äî –≥—É–±—ã, –≥–ª–∞–∑–∞, —Ç–æ–Ω, –±–∞–∑–∞

### –û—Ç—á—ë—Ç—ã
- **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç** ‚Äî –ø–ª–∞–Ω/—Ñ–∞–∫—Ç –ø–æ –≤—Å–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- **–û—Ç—á—ë—Ç—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º** ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
- **–¢–æ–ø-10 —Ç–æ–≤–∞—Ä–æ–≤** ‚Äî –ª–∏–¥–µ—Ä—ã –ø–æ –≤—ã—Ä—É—á–∫–µ —Å MoM —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º
- **–¢–æ–ø-20 —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º —Ä–æ—Å—Ç–∞** ‚Äî –±—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã, —á—Ç–æ —Ä–∞–∑–æ–≥–Ω–∞—Ç—å, —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–µ
- **Drill-down –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º** ‚Äî –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

### –ú–µ—Ç—Ä–∏–∫–∏
- –ü–ª–∞–Ω/–§–∞–∫—Ç –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏ MTD (—Å –Ω–∞—á–∞–ª–∞ –º–µ—Å—è—Ü–∞)
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ (%)
- MoM —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ (–º–µ—Å—è—Ü –∫ –º–µ—Å—è—Ü—É)
- DRR (–¥–æ–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤)
- Growth Score (—Å–∫–æ—Ä–∏–Ω–≥ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ —Ä–æ—Å—Ç–∞)
- –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Ü–µ–Ω—ã
- –ü—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å (profit proxy)

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –∏ views
- –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã (–∫–æ–ª–æ–Ω–∫–∏, —Ç–∏–ø—ã, —Å–≤—è–∑–∏)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (row count, distinct, null rate, min/max)
- –ü—Ä–∏–º–µ—Ä—ã —Å—Ç—Ä–æ–∫ (sample rows)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd telegram-sales-bot
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:

```env
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
TELEGRAM_BOT_TOKEN=your_bot_token_here

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–±–µ–∑ –Ω–∏—Ö —Ä–∞–±–æ—Ç–∞—é—Ç mock –¥–∞–Ω–Ω—ã–µ)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_KEY=your_service_role_key

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–±–µ–∑ –Ω–µ–≥–æ –±–∞–∑–æ–≤—ã–µ –æ—Ç—á—ë—Ç—ã)
ANTHROPIC_API_KEY=sk-ant-your_key
```

### 3. –ó–∞–ø—É—Å–∫

```bash
npm start
# –∏–ª–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev
```

## üì± –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Ç—á—ë—Ç—ã
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/daily` | –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –ø–æ –≤—Å–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º |
| `/face` | –û—Ç—á—ë—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –õ–∏—Ü–æ |
| `/hair` | –û—Ç—á—ë—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –í–æ–ª–æ—Å—ã |
| `/body` | –û—Ç—á—ë—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¢–µ–ª–æ |
| `/makeup` | –û—Ç—á—ë—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ú–∞–∫–∏—è–∂ |

### –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/drill <–∫–∞—Ç–µ–≥–æ—Ä–∏—è>` | –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (drill-down) |
| `/top10 <–∫–∞—Ç–µ–≥–æ—Ä–∏—è>` | –¢–æ–ø-10 —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –≤—ã—Ä—É—á–∫–µ |
| `/top20 <–∫–∞—Ç–µ–≥–æ—Ä–∏—è>` | –¢–æ–ø-20 —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º —Ä–æ—Å—Ç–∞ |

### –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/tables` | –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü |
| `/schema <—Ç–∞–±–ª–∏—Ü–∞>` | –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã |
| `/stats <—Ç–∞–±–ª–∏—Ü–∞>` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ç–∞–±–ª–∏—Ü—ã |
| `/sample <—Ç–∞–±–ª–∏—Ü–∞>` | –ü—Ä–∏–º–µ—Ä—ã —Å—Ç—Ä–æ–∫ |

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Supabase)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
dim_categories     ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
dim_products       ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–æ–≤–∞—Ä–æ–≤
dim_calendar       ‚Äî –∫–∞–ª–µ–Ω–¥–∞—Ä—å

fact_sales_daily   ‚Äî –ø—Ä–æ–¥–∞–∂–∏ –ø–æ –¥–Ω—è–º
plan_sales_daily   ‚Äî –ø–ª–∞–Ω –ø—Ä–æ–¥–∞–∂
fact_ads_daily     ‚Äî —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã
fact_price_daily   ‚Äî –∏—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω
```

### Views –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

```
v_category_plan_fact_today    ‚Äî –ø–ª–∞–Ω/—Ñ–∞–∫—Ç —Å–µ–≥–æ–¥–Ω—è
v_category_plan_fact_mtd      ‚Äî –ø–ª–∞–Ω/—Ñ–∞–∫—Ç MTD
v_subcategory_plan_fact_mtd   ‚Äî –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ MTD
v_top_products_by_category_mtd ‚Äî —Ç–æ–ø —Ç–æ–≤–∞—Ä–æ–≤
v_top_products_mom_compare    ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ MoM
v_top20_growth_candidates     ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–æ—Å—Ç–∞
v_price_stability             ‚Äî –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Ü–µ–Ω
v_profit_proxy                ‚Äî –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ö–µ–º—ã

1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ [Supabase](https://supabase.com)
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ `supabase/schema.sql`
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ `supabase/views.sql`
4. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ: `supabase/seed.sql`

## ü§ñ Claude API

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Claude –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
- –¢–µ–∫—Å—Ç–æ–≤—ã—Ö –æ—Ç—á—ë—Ç–æ–≤ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
- –ê–Ω–∞–ª–∏–∑–∞ "—á—Ç–æ –∏–¥—ë—Ç –∫–ª–∞—Å—Å–Ω–æ / –Ω–∞ —á—Ç–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ"
- Action items –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ä–æ—Å—Ç–∞

–ë–µ–∑ API –∫–ª—é—á–∞ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±–∞–∑–æ–≤—ã–º–∏ –æ—Ç—á—ë—Ç–∞–º–∏ (—Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ).

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-------------|----------|
| `TELEGRAM_BOT_TOKEN` | ‚úÖ | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather |
| `SUPABASE_URL` | ‚ùå | URL –ø—Ä–æ–µ–∫—Ç–∞ Supabase |
| `SUPABASE_SERVICE_KEY` | ‚ùå | Service Role –∫–ª—é—á Supabase |
| `ANTHROPIC_API_KEY` | ‚ùå | API –∫–ª—é—á Claude |
| `ALLOWED_USER_IDS` | ‚ùå | –°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö user_id |
| `DAILY_CRON` | ‚ùå | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∏ (cron) |
| `DAILY_CHAT_IDS` | ‚ùå | –ß–∞—Ç—ã –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ |
| `WEBHOOK_URL` | ‚ùå | URL –¥–ª—è webhook (production) |
| `PORT` | ‚ùå | –ü–æ—Ä—Ç –¥–ª—è webhook |

### –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞

```env
# –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00 –ø–æ –±—É–¥–Ω—è–º
DAILY_CRON=0 9 * * 1-5

# –ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å
DAILY_CHAT_IDS=123456789,-1001234567890
```

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞

```env
# –¢–æ–ª—å–∫–æ —ç—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞
ALLOWED_USER_IDS=123456789,987654321
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
telegram-sales-bot/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ bot.js              # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ commands.js     # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ supabase.js     # –†–∞–±–æ—Ç–∞ —Å Supabase
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ claude.js       # –†–∞–±–æ—Ç–∞ —Å Claude API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ metadata.js     # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îî‚îÄ‚îÄ formatters.js   # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ supabase/
‚îÇ   ‚îú‚îÄ‚îÄ schema.sql          # –°—Ö–µ–º–∞ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ views.sql           # Views –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ seed.sql            # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
```

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ (—Å nodemon)
npm run dev

# –ó–∞–ø—É—Å–∫ –≤ production
npm start
```

## üö¢ –î–µ–ø–ª–æ–π

### –í–∞—Ä–∏–∞–Ω—Ç 1: VPS / VM

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º
git clone <repo>
cd telegram-sales-bot

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º
npm install
cp .env.example .env
nano .env

# –ó–∞–ø—É—Å–∫–∞–µ–º —á–µ—Ä–µ–∑ PM2
npm install -g pm2
pm2 start src/bot.js --name sales-bot
pm2 save
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Docker

```dockerfile
FROM node:20-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
CMD ["node", "src/bot.js"]
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: Serverless (—Å webhook)

```env
WEBHOOK_URL=https://your-domain.com/webhook
PORT=3000
```

## üìä –§–æ—Ä–º—É–ª—ã –º–µ—Ç—Ä–∏–∫

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞
```
completion_pct = (fact / plan) * 100
```

### MoM (Month over Month)
```
mom_pct = ((current_mtd - prev_mtd) / prev_mtd) * 100
```

### DRR (–î–æ–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤)
```
drr_pct = (ads_spend / revenue) * 100
```

### Growth Score
```
score = (mom_growth * 0.3) + (margin * 0.3) + (stability * 0.2) - (drr * 0.2)
```

### –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Ü–µ–Ω—ã
```
price_cv = (std_price / avg_price) * 100
```

### Profit Proxy
```
profit = revenue * margin_pct - revenue * commission_pct - ads_spend
```

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## üôã –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É.
